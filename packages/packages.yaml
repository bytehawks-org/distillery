package:
  openssl:
    variant:
      - name: [ old-legacy, legacy ]
        major_version: 3.0
        patch_version: 18
        full_version: 3.0.18
      - name: stable
        major_version: 3.5
        patch_version: 4
        full_version: 3.5.4
      - name: stream
        major_version: 3.6
        patch_version: 0
        full_version: 3.6.0
    website: https://www.{{ name }}.org/
    git:
      repo: https://github.com/{{ name }}/{{ name }}/
      release_url_name_template: "{{ name }}-{{ full_version }}.tar.gz"
      release_download_url_template: "{{ git.repo }}/releases/tag/{{ name }}-{{ full_version }}/{{ name }}-{{ full_version }}.tar.gz"
    commands:
      pre: |
        wget -O {{ config.default_download_path }}/{{ name }}-{{ full_version }}.tar.gz {{ git.release_download_url_template }}
        tar -xzf {{ config.default_download_path }}/{{ name }}-{{ full_version }}.tar.gz -C {{ config.default_src_path }}
        cd {{ config.default_src_path }}/{{ name }}-{{ full_version }}
      patches:
        - url: https://www.openssl.org/news/openssl-3.0.18-legacy-compatibility.patch
          sha256: d3f6e2f4f4e1b3e4c5f6a7b8c9d0e1f2a3b4c5d6e7f8g9h0i1j2k3l4m5n6o7p8
          metadata:
            comment: "Compatibility patch for legacy versions"
          when:
            variant_name: old-legacy
            full_version: 3.0.18

      configure: |
        ./Configure linux-x86_64 \
          --prefix={{ default_prefix }} \
          --openssldir={{ default_prefix }}/etc/ssl \
          -static \
          no-shared \
          no-tests \
          no-docs
      make: make
      install: make install_sw
    tags:
      - library
      - application

#  zlib:
#    variant:
#      - name: all
#        major_version: 1.3
#        patch_version: 1
#        full_version: 1.3.1
#    website: https://zlib.net/
#    git_repo: https://github.com/madler/zlib
#    tags:
#      - library
#    
#  pcre2:
#    variant:
#      - name: all
#        major_version: 10
#        patch_version: 43
#        full_version: 10.43
#        website: https://www.pcre.org/
#    git_repo: https://github.com/PCRE2Project/pcre2
#    tags:
#      - library
#
#binaries:
#  nginx:
#    version: 1.26.2
#    depends_on: [musl, openssl, zlib, pcre]
#    configure_flags: "--with-cc=musl-gcc --with-ld-opt=-static"
#    
#  postgresql:
#    version: 16.1
#    depends_on: [musl, openssl, zlib]
#    
#  valkey:
#    version: 8.0
#    depends_on: [musl]  # standalone, no deps
#
#